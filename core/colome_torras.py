###################################################################################
# Algorithm implemented from Colome and Torras
###################################################################################